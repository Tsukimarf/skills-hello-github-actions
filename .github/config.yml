# Configuration File
# Version: 2.0
# Last Updated: January 2025

# =============================================================================
# APPLICATION SETTINGS
# =============================================================================
application:
  name: "MyProject"
  version: "2.0.0"
  environment: "production"  # development, staging, production
  debug: false
  timezone: "UTC"

# =============================================================================
# SERVER CONFIGURATION
# =============================================================================
server:
  host: "0.0.0.0"
  port: 8080
  workers: 4
  timeout: 30  # seconds
  max_connections: 1000
  
  # TLS/SSL Configuration
  tls:
    enabled: true
    cert_file: "/path/to/cert.pem"
    key_file: "/path/to/key.pem"
    min_version: "1.2"  # TLS 1.2 minimum

# =============================================================================
# DATABASE CONFIGURATION (v2.x format)
# =============================================================================
database:
  # Primary database connection
  connection:
    host: "localhost"
    port: 5432
    username: "db_user"
    password: "${DB_PASSWORD}"  # Use environment variable
    ssl_mode: "require"
    
  # Database settings
  database_name: "mydb"
  pool_size: 10
  max_overflow: 20
  pool_timeout: 30
  pool_recycle: 3600
  
  # Query settings
  query_timeout: 30000  # milliseconds
  statement_timeout: 60000
  
  # Backup configuration
  backup:
    enabled: true
    schedule: "0 2 * * *"  # Daily at 2 AM
    retention_days: 30
    path: "/backups/database"

# =============================================================================
# CACHE CONFIGURATION
# =============================================================================
cache:
  enabled: true
  type: "redis"  # redis, memcached, memory
  
  redis:
    host: "localhost"
    port: 6379
    password: "${REDIS_PASSWORD}"
    db: 0
    max_connections: 50
    socket_timeout: 5
    
  # Cache TTL settings (seconds)
  ttl:
    default: 3600
    short: 300
    long: 86400

# =============================================================================
# API CONFIGURATION
# =============================================================================
api:
  version: "v2"
  base_path: "/api/v2"
  
  # Rate limiting
  rate_limit:
    enabled: true
    requests_per_minute: 60
    burst_size: 100
    
  # CORS settings
  cors:
    enabled: true
    origins:
      - "https://example.com"
      - "https://app.example.com"
    methods:
      - "GET"
      - "POST"
      - "PUT"
      - "DELETE"
      - "PATCH"
    headers:
      - "Content-Type"
      - "Authorization"
    credentials: true
    max_age: 3600
  
  # API Keys
  authentication:
    type: "jwt"  # jwt, oauth2, api_key
    jwt:
      secret: "${JWT_SECRET}"
      algorithm: "HS256"
      expiration: 3600  # seconds
      refresh_enabled: true
      refresh_expiration: 604800  # 7 days

# =============================================================================
# LOGGING CONFIGURATION
# =============================================================================
logging:
  level: "info"  # debug, info, warning, error, critical
  format: "json"  # json, text
  
  # Output destinations
  outputs:
    - type: "console"
      enabled: true
      
    - type: "file"
      enabled: true
      path: "/var/log/myapp/app.log"
      max_size: "100MB"
      max_backups: 10
      max_age: 30  # days
      compress: true
      
    - type: "syslog"
      enabled: false
      host: "localhost"
      port: 514
      
  # Log specific components
  loggers:
    database:
      level: "warning"
    api:
      level: "info"
    security:
      level: "info"

# =============================================================================
# SECURITY SETTINGS
# =============================================================================
security:
  # Session management
  session:
    cookie_name: "session_id"
    cookie_secure: true
    cookie_httponly: true
    cookie_samesite: "strict"
    max_age: 3600  # seconds
    
  # Password policy
  password:
    min_length: 12
    require_uppercase: true
    require_lowercase: true
    require_numbers: true
    require_special: true
    max_age_days: 90
    
  # Security headers
  headers:
    x_frame_options: "DENY"
    x_content_type_options: "nosniff"
    x_xss_protection: "1; mode=block"
    strict_transport_security: "max-age=31536000; includeSubDomains"
    content_security_policy: "default-src 'self'"
    
  # Encryption
  encryption:
    algorithm: "AES-256-GCM"
    key: "${ENCRYPTION_KEY}"

# =============================================================================
# EMAIL CONFIGURATION
# =============================================================================
email:
  enabled: true
  provider: "smtp"  # smtp, sendgrid, ses
  
  smtp:
    host: "smtp.example.com"
    port: 587
    username: "noreply@example.com"
    password: "${SMTP_PASSWORD}"
    use_tls: true
    
  from:
    address: "noreply@example.com"
    name: "MyProject Team"
    
  templates:
    path: "/templates/email"
    
  # Rate limiting for emails
  rate_limit:
    max_per_hour: 100
    max_per_day: 1000

# =============================================================================
# FILE STORAGE
# =============================================================================
storage:
  type: "s3"  # local, s3, gcs, azure
  
  local:
    path: "/var/data/uploads"
    max_size: "10MB"
    
  s3:
    bucket: "myproject-files"
    region: "us-east-1"
    access_key: "${AWS_ACCESS_KEY}"
    secret_key: "${AWS_SECRET_KEY}"
    endpoint: null  # Optional for S3-compatible services
    
  # File upload restrictions
  uploads:
    max_size: "10MB"
    allowed_extensions:
      - "jpg"
      - "jpeg"
      - "png"
      - "pdf"
      - "doc"
      - "docx"
    scan_for_viruses: true

# =============================================================================
# MONITORING & METRICS
# =============================================================================
monitoring:
  enabled: true
  
  # Health check endpoint
  health_check:
    enabled: true
    path: "/health"
    
  # Metrics collection
  metrics:
    enabled: true
    provider: "prometheus"  # prometheus, datadog, statsd
    port: 9090
    path: "/metrics"
    
  # Application Performance Monitoring
  apm:
    enabled: true
    provider: "newrelic"  # newrelic, datadog, elastic
    api_key: "${APM_API_KEY}"
    sample_rate: 0.1  # 10% of requests

# =============================================================================
# BACKGROUND JOBS
# =============================================================================
jobs:
  enabled: true
  
  # Queue configuration
  queue:
    type: "redis"  # redis, rabbitmq, sqs
    host: "localhost"
    port: 6379
    
  # Worker settings
  workers:
    count: 4
    max_retries: 3
    retry_delay: 60  # seconds
    
  # Scheduled jobs
  schedules:
    - name: "cleanup_old_sessions"
      schedule: "0 0 * * *"  # Daily at midnight
      enabled: true
      
    - name: "send_daily_reports"
      schedule: "0 8 * * *"  # Daily at 8 AM
      enabled: true
      
    - name: "backup_database"
      schedule: "0 2 * * *"  # Daily at 2 AM
      enabled: true

# =============================================================================
# FEATURE FLAGS
# =============================================================================
features:
  new_authentication: true
  beta_api_endpoints: false
  experimental_cache: false
  maintenance_mode: false
  
  # A/B testing
  ab_testing:
    enabled: true
    experiments:
      new_ui:
        enabled: true
        percentage: 50

# =============================================================================
# THIRD-PARTY INTEGRATIONS
# =============================================================================
integrations:
  # Analytics
  analytics:
    google_analytics:
      enabled: true
      tracking_id: "UA-XXXXXXXXX-X"
      
  # Error tracking
  error_tracking:
    sentry:
      enabled: true
      dsn: "${SENTRY_DSN}"
      environment: "production"
      traces_sample_rate: 0.1
      
  # Payment processing
  payment:
    stripe:
      enabled: true
      public_key: "${STRIPE_PUBLIC_KEY}"
      secret_key: "${STRIPE_SECRET_KEY}"
      webhook_secret: "${STRIPE_WEBHOOK_SECRET}"

# =============================================================================
# DEVELOPMENT SETTINGS (Override in development environment)
# =============================================================================
development:
  debug: true
  auto_reload: true
  show_errors: true
  
  # Mock external services
  mock_services:
    email: true
    payment: true
    sms: false

# =============================================================================
# TESTING SETTINGS
# =============================================================================
testing:
  database:
    connection:
      host: "localhost"
      port: 5432
      username: "test_user"
      password: "test_password"
    database_name: "test_db"
    
  # Use in-memory cache for tests
  cache:
    type: "memory"
    
  # Disable external services in tests
  integrations:
    email: false
    payment: false
    analytics: false